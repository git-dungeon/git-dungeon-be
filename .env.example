# 기본 서버 포트
PORT=3000

# 로그 레벨 (fatal|error|warn|info|debug|trace|silent)
LOG_LEVEL=info

# 개발 환경에서 가독성을 위한 로그 포맷
LOG_PRETTY=true

# CORS 허용 오리진 (콤마 구분). '*' 입력 시 전체 허용
CORS_ALLOWED_ORIGINS=http://localhost:4173,http://localhost:5173,https://staging.gitdungeon.com,https://app.gitdungeon.com
CORS_ALLOW_CREDENTIALS=true

# 외부에 공개된 백엔드 기본 URL (프로토콜 포함)
PUBLIC_BASE_URL=http://localhost:3000
NODE_ENV=development

# ---------------------------------
# 각 환경별 설정 예시
# 개발환경 (위 기본값 사용)
# PUBLIC_BASE_URL=http://localhost:3000
# NODE_ENV=development

# 스테이징 환경
# PUBLIC_BASE_URL=https://staging-api.gitdungeon.com
# NODE_ENV=staging

# 프로덕션 환경
# PUBLIC_BASE_URL=https://api.gitdungeon.com
# NODE_ENV=production
# ---------------------------------

# PostgreSQL 접속 정보 (docker compose 기본값과 일치)
DATABASE_URL=postgresql://gitdungeon:gitdungeon@localhost:5432/git_dungeon?schema=public
DATABASE_SHADOW_URL=postgresql://gitdungeon:gitdungeon@localhost:5432/git_dungeon_shadow?schema=public

# Prisma 쿼리 로깅/연결 제어
DATABASE_LOG_QUERIES=false
DATABASE_SKIP_CONNECTION=false

# Docker Compose 연동 시 PostgreSQL 컨테이너 기본값
POSTGRES_PORT=5432
POSTGRES_USER=gitdungeon
POSTGRES_PASSWORD=gitdungeon
POSTGRES_DB=git_dungeon

# GitHub OAuth (better-auth)
AUTH_GITHUB_CLIENT_ID=replace-me
AUTH_GITHUB_CLIENT_SECRET=replace-me
AUTH_GITHUB_REDIRECT_URI=http://localhost:3000/api/auth/callback/github
AUTH_GITHUB_SCOPE=read:user,user:email

# GitHub 동기화
GITHUB_SYNC_PAT=
GITHUB_SYNC_PATS=
GITHUB_SYNC_ENDPOINT=https://api.github.com/graphql
GITHUB_SYNC_USER_AGENT=git-dungeon-backend
GITHUB_SYNC_RATE_LIMIT_FALLBACK_REMAINING=100
GITHUB_SYNC_CRON=0 0 0 * * *
GITHUB_SYNC_BATCH_SIZE=50
GITHUB_SYNC_MANUAL_COOLDOWN_MS=21600000
REDIS_URL=redis://localhost:6379
REDIS_SKIP_CONNECTION=false
# GitHub 토큰 보호/레이트 리밋 캐시 (Redis)
GITHUB_TOKEN_LOCK_TTL_MS=30000
GITHUB_TOKEN_RATE_LIMIT_CACHE_MS=300000
GITHUB_TOKEN_COOLDOWN_MS=900000
# 테스트 전용: GitHub GraphQL 강제 레이트 리밋 트리거 (prod에서 사용 금지)
# TEST_FORCE_GITHUB_RATE_LIMIT=false
DUNGEON_INITIAL_AP=10

# Dungeon 배치 스케줄링
DUNGEON_BATCH_CRON=*/5 * * * *
DUNGEON_BATCH_MAX_USERS_PER_TICK=200
DUNGEON_BATCH_MAX_ACTIONS_PER_USER=5
DUNGEON_BATCH_MIN_AP=1
DUNGEON_BATCH_INACTIVE_DAYS=30
DUNGEON_BATCH_LOCK_TTL_MS=60000
DUNGEON_BATCH_LOCK_BACKOFF_MS=200
DUNGEON_BATCH_LOCK_MAX_RETRY=3
QUEUE_RETRY_MAX=3
QUEUE_RETRY_BACKOFF_BASE_MS=1500
QUEUE_RETRY_TTL_MS=7200000
QUEUE_RETRY_CONCURRENCY=5
QUEUE_DLQ_TTL_DAYS=7
ALERT_WEBHOOK_URL=
ALERT_FAILURE_THRESHOLD=3
